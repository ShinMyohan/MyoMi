<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="UserMapper">
	<resultMap id="User" type="User" autoMapping="true">
			<id property="id" column="id" javaType="String"/>
			<result property="pwd" column="pwd"/>
			<result property="name" column="name"/>
			<result property="tel" column="tel"/>
			<result property="email" column="email"/>
			<result property="addr" column="addr"/>
			<result property="role" column="role"/>
			<result property="membershipNum" column="membership_num"/>
			<result property="createdDate" column="created_date"/>
			<result property="signoutDate" column="signout_date"/>

	</resultMap>
	
	<!--회원 전체 조회-->
	<select id="selectAllUser" resultType="User">
		SELECT id, pwd,name,tel,email,addr,role,membership_num,created_date,signout_date FROM users
 		<!-- ORDER BY num; -->
	</select>
	
	<!--회원가입-->
	<insert id="insertUser" parameterType="map" keyProperty="map">
	INSERT INTO users (id,pwd,name,tel,email,addr,role,membership_num,created_date,signout_date) 
	VALUES (#{id}, #{pwd}, #{name}, #{tel}, #{email}, #{addr}, #{role}, #{membership_num}, #{created_date}, #{signout_date})
	</insert>
	
		<!--로그인하기/로그인하면 내정보 불러오기-->
	<select id = "selectLoginUser" resultType="User">
	SELECT id, pwd, name, tel, email, addr, role, membership_num, created_date, signout_date from users where id = #{id} and pwd =#{pwd}
	</select>
	
	<!--아이디 찾기-->
	<select id="selectFindIdUser" resultType ="String">
	SELECT id from users where email=#{email}
	</select>
	
	<!--비밀번호 찾기-->
	<select id ="selectFindPwdUser" parameterType="map" resultType ="map">
	SELECT pwd from users where id=#{id} and email=#{email}
	</select>
	
	<!--회원탈퇴(탈퇴일 업데이트)-->
	<update id ="updateSignoutUser">
	UPDATE users set signout_date = sysdate where id = #{id}
	</update>
	
	<!--내정보 변경하기-->
	<update id = "updateEditUser">
    UPDATE users set pwd = #{pwd} ,email = #{email} , tel = #{tel}
    where id = #{id}
	</update>
	
	<!--내가쓴 상품리뷰 목록 조회-->
	<select id = "selectReviewByUser" resultType="map"> 
	SELECT num, title, created_date, stars, content from review
    where user_id = #{review.user.id}
	</select>	
	
	<!--내가쓴 상품리뷰 재목으로 검색-->
	<select id = "selectReviewFindTitleUser" resultType="Review">
	SELECT num, title, created_date, stars from review
    where title like #{title}
    and user_id = #{review.user.id}
	</select>
	
	<!---->
	
	
	
	
	
	
	
</mapper>